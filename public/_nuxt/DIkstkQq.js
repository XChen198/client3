import{E}from"./CAYgcm9m.js";import{E as b}from"./DjFJZaCT.js";import{E as V,a as v}from"./Dkidm5em.js";import{E as F}from"./DG4vFwbg.js";import"./BO-BUzP0.js";import{E as f}from"./Dtsb2UZl.js";import{f as B,g as N,r as h,J as w,c as C,b as o,w as t,a as I,j as a,N as M,o as R,d as u}from"./CsIamsOv.js";import{u as U}from"./BTDj4EH4.js";import{c as j}from"./mO1Piuff.js";import{l as k}from"./Bd0GBrjl.js";import"./DsaM66V6.js";import"./r5W6hzzQ.js";const q={class:"myinfo",style:{"margin-top":"20px"}},W=B({__name:"info",setup(S){const _=N(),c=U(),i=h(),s=w({oldPassword:"",newPassword:""}),p=(m,e,r)=>{e===""?r(new Error("密码不能为空")):e.length<6?r(new Error("密码长度不能小于6位")):r()},g=w({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{validator:p,trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:p,trigger:"blur"}]}),y=m=>{m&&m.validate(async e=>{if(e){const r=await j(s.oldPassword,s.newPassword),l=r?await r.json():null;l.code===0?(f({message:l.message,type:"success"}),s.oldPassword="",s.newPassword="",k(),_.push("/")):f({message:l.message,type:"error"})}else return console.log("error submit!"),!1})};return(m,e)=>{const r=E,l=b,d=v,P=F,x=V;return R(),C(M,null,[o(r,{class:"mx-1",type:"info"},{default:t(()=>[u("我的信息")]),_:1}),I("div",q,[o(x,{ref_key:"ruleFormRef",ref:i,model:a(s),rules:a(g),style:{"max-width":"600px",margin:"0 auto"}},{default:t(()=>[o(d,{label:"用户名 :"},{default:t(()=>{var n;return[o(l,{value:(n=a(c).userInfo)==null?void 0:n.username,disabled:"",style:{"max-width":"600px",margin:"0 auto"}},null,8,["value"])]}),_:1}),o(d,{label:"旧密码 :",prop:"oldPassword"},{default:t(()=>[o(l,{modelValue:a(s).oldPassword,"onUpdate:modelValue":e[0]||(e[0]=n=>a(s).oldPassword=n),modelModifiers:{trim:!0},type:"password"},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码 :",prop:"newPassword"},{default:t(()=>[o(l,{modelValue:a(s).newPassword,"onUpdate:modelValue":e[1]||(e[1]=n=>a(s).newPassword=n),modelModifiers:{trim:!0},type:"password"},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(P,{type:"primary",onClick:e[2]||(e[2]=n=>y(a(i))),style:{width:"100%"}},{default:t(()=>[u("重置密码")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),o(r,{class:"mx-1",type:"warning",style:{margin:"0 auto"}},{default:t(()=>[u("修改成功后需重新登录")]),_:1})],64)}}});export{W as default};
